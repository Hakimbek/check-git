services:
    default:
        autoScaling:
            max:
                feature: 1
                release: 8
            min:
                feature: 1
                release: 4
            cpuThreshold: 70
            memoryThreshold: 70
            lowCpuThreshold: 30
            lowMemoryThreshold: 50
        memory:
            release: 2048
            feature: 512
        cpu:
            release: 1024
            feature: 256

logs:
    type: logstash
    host: naprd-li-logstash.wkgposvc.cloud
    port: '444'
    index: gpo-ps-hub2-prd-ohio-ac
    clientId: ANSWERCONNECT
    tls: On
    tlsVerify: Off

containers:
    csn:
        build: '.'
        environment:
            env: prod-ohio
            PORT: 8005
            REDIS_AUTH_APPLICATION: { type: ssm, path: /REDIS_AUTH_APPLICATION/PROD-OHIO }
            AXCESS_INTEGRATOR_KEY: { type: ssm, path: /AXCESS_INTEGRATOR_KEY/PROD-OHIO }
            ARMAC_KTMINE_KEY: { type: ssm, path: /ARMAC_KTMINE_KEY/PROD-OHIO }
            ARMAC_LICENSE_API_KEY: { type: ssm, path: /LICENSE_SERVICE/PROD }
            ELASTIC_APM_SECRET_TOKEN: { type: ssm, path: /ELASTIC_APM_SECRET_TOKEN/PROD-OHIO }
            AWS_BRAND_LOGO_BUCKET_ACCESS_KEY: { type: ssm, path: /BRAND_LOGOS_S3_BUCKET_ACCESS_KEY/PROD }
            AWS_BRAND_LOGO_BUCKET_SECRET_KEY: { type: ssm, path: /BRAND_LOGOS_S3_BUCKET_SECRET_KEY/PROD }
            AWS_AXCESS_BUCKET_ACCESS_KEY: { type: ssm, path: /AXCESS_COMPLEXITY_FACTORS_AWS_BUCKET_ACCESS_KEY/PROD }
            AWS_AXCESS_BUCKET_SECRET_KEY: { type: ssm, path: /AXCESS_COMPLEXITY_FACTORS_AWS_BUCKET_SECRET_KEY/PROD }
            AWS_EDWARD_JONES_COUPON_CODES_KEY: { type: ssm, path: /EDWARD_JONES_COUPON_CODES/PROD }
            AWS_BEYOND_API_KEY: { type: ssm, path: /BEYOND_API_KEY/PROD }

    gateway:
        environment:
            ##### General gateway config #####
            REDIS_HOST: master.acr3812788kugwb.ggmy0m.use2.cache.amazonaws.com:6379
            REDIS_AUTH: { type: ssm, path: /REDIS_AUTH_GATEWAY/PROD-OHIO }
            REDIS_KEY_PREFIX: prd


            ##### IDPs config #####
            # OneID (default) IDP config
            idp_OneID: https://login.wolterskluwer.com/
            idp_OneID_client_id: TAA.AnswerConnectOrchestrated
            idp_OneID_client_secret: { type: ssm, path: /IDP_ONEID_CLIENT_SECRET/PROD-OHIO }
            idp_OneID_end_session_endpoint: https://login.wolterskluwer.com/as/authorization.oauth2?client_id=TAA.AnswerConnectOrchestrated&response_type=code&logout=true
            idp_OneID_relogin_parameters: logout_uri=https://answerconnect.cch.com/static/logout&redirect_uri=https://answerconnect.cch.com/static/logout

            # Axcess IDP config
            idp_AxcessIDP: https://login.cchaxcess.com/
            idp_AxcessIDP_client_id: TAA.AnswerConnect.PROD
            idp_AxcessIDP_client_secret: { type: ssm, path: /IDP_AXCESSIDP_CLIENT_SECRET/PROD-OHIO }

            # IDP config for extra scope for URM token exchange flow
            idp_tokenexchange: https://login.wolterskluwer.com/
            idp_tokenexchange_client_id: TAA.ACSTS
            idp_tokenexchange_client_secret: { type: ssm, path: /IDP_ONEID_EXCHANGE_TOKEN_SECRET/PROD }

            # IDP config for Taskflow API token exchange flow
            idp_oneidtokenexchangetfidp: https://login.wolterskluwer.com/
            idp_oneidtokenexchangetfidp_client_id: TAA.AC2TaskFlow
            idp_oneidtokenexchangetfidp_client_secret: { type: ssm, path: /IDP_ONEID_TASKFLOW_CLIENT_SECRET/PROD-OHIO }

            # IDP Config for ARM WNC feature technical user token
            idp_wncidp: https://login.wolterskluwer.com/
            idp_wncidp_client_id: TAAUS.AnswerConnect-wnc.PRD
            idp_wncidp_client_secret: { type: ssm, path: /IDP_ONEID_CC_WNC_SECRET/PROD }


            ##### Freemium users config #####
            freemium_default_password: { type: ssm, path: /FREEMIUM_PASSWORD/PROD-OHIO }
            freemium_freeuser_password: { type: ssm, path: /FREEMIUM_PASSWORD/PROD-OHIO }
            freemium_gpduser_password: { type: ssm, path: /FREEMIUM_GPD_PASSWORD/PROD-OHIO }


            ##### Services config #####
            # OSA Services config
            OSA_URL: services.intelliconnect.cch.com/@@OSA-DOMAIN-NAME@@.svc
            service_osashortify_url: linkrouter.msc-na-prod.wkgposvc.cloud/NAPROD/Shortify.svc
            service_osabrowse_url: prd-na-regent.wkgposvc.cloud/osa/browse/
            service_osauseractivityhistory_url: https://useractivity.prd-na-onega.wkgposvc.cloud/NAPROD/Useractivityhistory.svc/
            ## Separate OSA URM config for requests with token with specific scope (ARM concurrency feature)
            service_privateurm_url: http://services.intelliconnect.cch.com/Urm.svc
            ## Separate OSA Research config for requests with token from specific idp config (ARM WNC feature)
            service_wnc_url: http://services.intelliconnect.cch.com/Research.svc

            # Non-OSA services configs
            service_converter_url: https://htmlconv.msc-na-prod.wkgposvc.cloud/
            service_velvet_url: p-velvet.intelliconnect.cch.com/
            service_axcessdocument_url: https://api.cchaxcess.com/api/DocumentService
            service_tf_url: https://fdca.pubrepl.tfprod.app


            ##### Hooks config #####
            hook_beyond_condition: tokenPayload/sub!=795099d97a24201a67236a3c07fd9082880577ab&httpCookie/previously_logged_in=true&http/path[]=/api/beyond/**


            ##### Resource access restriction #####
            authorization_protected_condition: tokenPayload/sub=795099d97a24201a67236a3c07fd9082880577ab&httpCookie/previously_logged_in=true

network:
    vpcId: vpc-0efba63f77d7edb39
    publicSubnets:
      - subnetId: subnet-04b55e7d137be233b
        availabilityZone: us-east-2a
      - subnetId: subnet-0ef690c949eb8848c
        availabilityZone: us-east-2b
    privateSubnets:
      - subnetId: subnet-0ac6bfc7dffa7b723
        availabilityZone: us-east-2a
      - subnetId: subnet-0c463350e0abfe58c
        availabilityZone: us-east-2b

aws:
    tags:
        wk_environment_name: prd
        wk_environment_type: prod
